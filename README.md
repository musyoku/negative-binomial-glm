## 負の二項分布の一般化線形モデルによる最大単語長の予測

Negative Binomial Generalized Linear Modelによる最大単語長の予測の実験コードです。

半教師あり形態素解析でラティスの圧縮に用います。

## 使用

### 動作に必要なもの

- C++ コンパイラ
	- GCC と Apple LLVM で動作を確認しています

- Boost
	- 不完全ベータ関数で使います

### ビルドと実行

```
make train
make test
```

```
./train
./test
```

### パラメータ

- coverage
	- tから何文字を対象に素性ベクトルを作るか
	- contとchに影響する

- c_max
	- 素性にする文字をtから何文字にするか

- t_max
	- tから何文字までの文字種を素性にするか

- sigma
	- MCMCのランダムウォーク時のノイズの標準偏差

重みの事前分布は平均0、分散1の正規分布で固定です。

## 結果

ネットで収集したテキスト78万行のうち10万行を学習、68万行をテストに用いました。

以下は全てテストデータでの結果です。

学習時間がまだ足りていないので精度はさらに上がると思います。

### 真の単語長ごとの予測精度

```
L	Precision 
1:	1
2:	0.999912
3:	0.999711
4:	0.998307
5:	0.959728
6:	0.941199
7:	0.921307
8:	0.868079
9:	0.823721
10:	0.762555
11:	0.730597
12:	0.691079
13:	0.534417
14:	0.416058
15:	0.294695
16:	0.278378
n ≥ 5:	0.925166
all:	0.99697
```

L: 真の単語長

### 予測単語長の頻度

```
L	Frequency
1:	899
2:	5958
3:	255203
4:	1596573
5:	1523367
6:	1558698
7:	856454
8:	294007
9:	190648
10:	131755
11:	66447
12:	43787
13:	25067
14:	14828
15:	10875
16:	25724
```

L: 予測単語長

### 予測と真の単語長との誤差

```
L	Mean		StdDev
1:	3.51640:	1.04015
2:	4.10025:	1.11663
3:	4.02163:	1.78829
4:	3.94036:	2.23707
5:	3.92278:	2.75208
6:	3.87264:	2.74632
7:	3.76954:	2.58985
8:	5.06852:	3.42131
9:	3.68340:	3.60299
10:	2.45161:	3.84886
11:	1.31459:	3.63964
12:	0.48238:	3.71844
13:	-1.44455:	4.00386
14:	-2.66861:	4.17392
15:	-3.87033:	4.14080
16:	-4.87297:	4.29866
```

L: 真の単語長

## 参考文献

- [Inducing Word and Part-of-Speech with Pitman-Yor Hidden Semi-Markov Models](http://chasen.org/~daiti-m/paper/acl2015pyhsmm.pdf)